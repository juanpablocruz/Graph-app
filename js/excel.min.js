var table_data="";var columna=false,fila=false;_.prototype.display_table=function(x){var G={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:10,K:11,L:12,M:13,N:14,O:15,P:16,Q:17,R:18,S:19,T:20,U:21,V:22,W:23,X:23,Y:24,Z:25,AA:26,BB:27,CC:28,DD:29,EE:30,FF:31,GG:32,HH:33,II:34,JJ:35,KK:36,LL:37,MM:38,NN:39,OO:40,PP:41,QQ:42,RR:43,SS:44,TT:45,UU:46,VV:47,WW:48,XX:49,YY:50,ZZ:51};var l;for(var d in x){var C=x[d]["!ref"].split(":")[1].split("");var k="";for(var y=1;y<C.length;y++){k+=C[y];}l={n:G[C[0]],m:k};var a=new Array();var B=new Array();for(var u=0;u<l.n+1;u++){a.push(new Array());B.push(new Array());for(var v=0;v<l.m;v++){a[u].push({col:0,row:0,data:"",sheet:0});B[u].push(0);}}for(var e in x[d]){if(typeof x[d][e]["raw"]!="undefined"){var s=$("<div col='"+e+"' sheet='"+d+"'>"+x[d][e]["raw"]+"</div>");var g=e.split("");row="";for(var y=1;y<g.length;y++){row+=g[y];}a[G[g[0]]-1][parseInt(row)]={col:g[0],row:row,data:x[d][e]["raw"],sheet:d};}}}var F=$("<table></table>");$("#output").html("");for(var y=0;y<l.n;y++){for(var w=0;w<l.m;w++){if(a[y][w]["data"]!=0){B[y][w]=1;}}}var e=new Array();for(var z=0;z<l.m;z++){var E=0;for(var D=0;D<l.n;D++){E+=B[D][z];}e.push(E);}var A=new Array();for(var D=0;D<l.n;D++){var E=0;for(var z=0;z<l.m;z++){E+=B[D][z];}A.push(E);}var p=findTable(e,A);var H=[];for(var y=0;y<p.cols.length;y++){var b=$("<tr></tr>");for(var w=0;w<p.rows.length;w++){var D=p.cols[y];var t=p.rows[w];var q="";if(!isNaN(parseFloat(a[t][D]["data"]))){q=Math.round(parseFloat(a[t][D]["data"])*100)/100;}else{q=a[t][D]["data"];}var h=$("<td><div class='dato drop'>"+q+"</div></td>");b.append(h);}F.append(b);}$("#output").append(F);_().saveStep();var o=new Array();$("#output tr").each(function(f,c){o.push(new Array());$(c).find("td").each(function(j,i){o[f].push($(i).text());});});_().loadOutput(JSON.stringify(o));};function draw(b){tipo=localStorage.chartType;var d=new Array();changeStep($(".current_step"),"next");switch(tipo){case"Tartas":for(var c=0;c<b.length;c++){_().each(Object.keys(b[c]),function(a,e){d.push({label:e[a],value:Math.round(b[c][e[a]]*100)/100});});}localStorage.data=JSON.stringify(d);_().saveStep();$(".loader").toggle();_("#graph").pie({data:d});break;case"Barras":localStorage.data=JSON.stringify(b);_().saveStep();$(".loader").toggle();_("#graph").bars({data:b});break;case"HistÃ³ricos":localStorage.data=JSON.stringify(b);localStorage.leyenda=Object.keys(b[0])[0];_().saveStep();$(".loader").toggle();_("#graph").history({data:b});break;}}function findMedian(c){var b=0;var a=0;c.forEach(function(d){b+=d;if(d!=0){a++;}});return Math.floor(b/a);}function foundRelativeModa(c){var b={};c.forEach(function(f){if(typeof b[f]=="undefined"&&f!=0){b[f]=1;}else{if(f!=0){b[f]=b[f]+1;}}});var a=0;var e=0;for(var d in b){if(b[d]>a){a=b[d];e=d;}}return e;}function calculateDistances(c){var a=new Array();for(var b=0;b<c.length-1;b++){a.push(c[b+1]-c[b]);}a.push(c[c.length-1]-c[c.length-2]);return a;}function findTable(g,k){var b=findMedian(g);var c=findMedian(k);var a=new Array;var f=new Array;var h=new Array;var j=new Array;if(b==1){b=2;}if(c==1){c=2;}for(var e=0;e<g.length;e++){if(g[e]>=b){a.push(e);}}for(var e=0;e<k.length;e++){if(k[e]>=c){f.push(e);}}var d={dc:calculateDistances(a),dr:calculateDistances(f)};for(var e=0;e<a.length;e++){if(d.dc[e]==1){h.push(a[e]);}}for(var e=0;e<f.length;e++){if(d.dr[e]==1){j.push(f[e]);}}return{cols:h,rows:j};}
